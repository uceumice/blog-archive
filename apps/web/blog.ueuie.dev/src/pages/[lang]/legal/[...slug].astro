---
import Legal from "../../../layouts/legal/legal.astro";
import { getLegalPage } from "../../../utils/contents/get-legal-page";
import { parse } from "../../../utils/i18n";
import { setCanonical } from "../../../utils/canonical";

/* -------------------------------------------------------------------------- */
/*                                     SSR                                    */
/* -------------------------------------------------------------------------- */
const lang = parse.lang(Astro.params.lang)!;
const slug = Astro.params.slug!;

/* --------------------------------- Content -------------------------------- */
const page = await getLegalPage(lang!, slug);
if (!page) {
  return Astro.redirect("/404");
}

const { Content } = await page.render();

/* --------------------------------- Headers -------------------------------- */
setCanonical(Astro, "legal", slug);
---

<Legal data={page.data} lang={lang}>
  <Content />
</Legal>
